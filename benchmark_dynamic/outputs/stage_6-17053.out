/var/spool/slurmd/job17053/slurm_script: line 14: cd: /work/y5jing/project2_test_4/benchmarks_dynamic/: No such file or directory
Jing Sole Experiment name: ALSTM_factor11_horizon10_step10_stopThreshold0.005_2024-08-05_12:25:24
creating tasks:   0%|          | 0/523 [00:00<?, ?it/s]creating tasks:  13%|█▎        | 70/523 [00:00<00:00, 697.31it/s]creating tasks:  27%|██▋       | 143/523 [00:00<00:00, 711.71it/s]creating tasks:  41%|████▏     | 216/523 [00:00<00:00, 716.46it/s]creating tasks:  55%|█████▌    | 288/523 [00:00<00:00, 717.75it/s]creating tasks:  69%|██████▉   | 361/523 [00:00<00:00, 719.54it/s]creating tasks:  83%|████████▎ | 434/523 [00:00<00:00, 720.79it/s]creating tasks:  97%|█████████▋| 507/523 [00:00<00:00, 545.64it/s]creating tasks: 100%|██████████| 523/523 [00:00<00:00, 632.08it/s]
creating tasks:   0%|          | 0/24 [00:00<?, ?it/s]creating tasks: 100%|██████████| 24/24 [00:00<00:00, 713.25it/s]
current epoch: 0
gpu-pr1-02                Mon Aug  5 12:25:27 2024  550.90.07
[0] NVIDIA A100 80GB PCIe | 39°C,   0 % |   513 / 81920 MB | y5jing(504M)
[1] NVIDIA A100-PCIE-40GB | 32°C,   0 % |     3 / 40960 MB |

train:   0%|          | 0/523 [00:00<?, ?it/s]train:   0%|          | 1/523 [00:00<05:04,  1.71it/s]train:   2%|▏         | 9/523 [00:01<00:57,  8.92it/s]train:   3%|▎         | 17/523 [00:01<00:44, 11.29it/s]train:   5%|▍         | 25/523 [00:02<00:40, 12.41it/s]train:   6%|▌         | 32/523 [00:02<00:37, 12.92it/s]train:   8%|▊         | 40/523 [00:03<00:36, 13.35it/s]train:   9%|▉         | 48/523 [00:03<00:34, 13.63it/s]train:  11%|█         | 56/523 [00:04<00:33, 13.81it/s]train:  12%|█▏        | 64/523 [00:05<00:32, 13.91it/s]train:  14%|█▍        | 72/523 [00:05<00:32, 14.00it/s]train:  15%|█▌        | 80/523 [00:06<00:31, 14.05it/s]train:  17%|█▋        | 88/523 [00:06<00:31, 14.02it/s]train:  18%|█▊        | 96/523 [00:07<00:30, 14.04it/s]train:  20%|█▉        | 104/523 [00:07<00:29, 14.05it/s]train:  21%|██▏       | 112/523 [00:08<00:29, 14.08it/s]train:  23%|██▎       | 120/523 [00:09<00:28, 14.08it/s]train:  24%|██▍       | 128/523 [00:09<00:28, 14.11it/s]train:  26%|██▌       | 136/523 [00:10<00:27, 14.14it/s]train:  28%|██▊       | 144/523 [00:10<00:26, 14.12it/s]train:  29%|██▉       | 152/523 [00:11<00:26, 14.11it/s]train:  31%|███       | 160/523 [00:11<00:25, 14.08it/s]train:  32%|███▏      | 168/523 [00:12<00:25, 14.09it/s]train:  34%|███▎      | 176/523 [00:13<00:26, 13.30it/s]train:  35%|███▌      | 184/523 [00:13<00:25, 13.53it/s]train:  37%|███▋      | 192/523 [00:14<00:24, 13.71it/s]train:  38%|███▊      | 200/523 [00:14<00:23, 13.85it/s]train:  40%|███▉      | 208/523 [00:15<00:22, 13.91it/s]train:  41%|████▏     | 216/523 [00:15<00:22, 13.95it/s]train:  43%|████▎     | 224/523 [00:16<00:21, 13.97it/s]train:  44%|████▍     | 232/523 [00:17<00:20, 14.03it/s]train:  46%|████▌     | 240/523 [00:17<00:20, 14.04it/s]train:  47%|████▋     | 248/523 [00:18<00:19, 14.01it/s]train:  49%|████▉     | 256/523 [00:18<00:19, 14.04it/s]train:  50%|█████     | 264/523 [00:19<00:18, 14.06it/s]train:  52%|█████▏    | 272/523 [00:19<00:17, 14.09it/s]train:  54%|█████▎    | 280/523 [00:20<00:17, 14.13it/s]train:  55%|█████▌    | 288/523 [00:21<00:16, 14.11it/s]train:  57%|█████▋    | 296/523 [00:21<00:16, 14.12it/s]train:  58%|█████▊    | 304/523 [00:22<00:15, 14.13it/s]train:  60%|█████▉    | 312/523 [00:22<00:14, 14.11it/s]train:  61%|██████    | 320/523 [00:23<00:14, 14.12it/s]train:  63%|██████▎   | 328/523 [00:23<00:13, 14.12it/s]train:  64%|██████▍   | 336/523 [00:24<00:13, 14.13it/s]train:  66%|██████▌   | 344/523 [00:25<00:12, 14.11it/s]train:  67%|██████▋   | 352/523 [00:25<00:12, 14.13it/s]train:  69%|██████▉   | 360/523 [00:26<00:11, 14.10it/s]train:  70%|███████   | 368/523 [00:26<00:10, 14.10it/s]train:  72%|███████▏  | 376/523 [00:27<00:10, 14.11it/s]train:  73%|███████▎  | 384/523 [00:27<00:09, 14.13it/s]train:  75%|███████▍  | 392/523 [00:28<00:09, 14.13it/s]train:  76%|███████▋  | 400/523 [00:28<00:08, 14.11it/s]train:  78%|███████▊  | 408/523 [00:29<00:08, 14.15it/s]train:  80%|███████▉  | 416/523 [00:30<00:07, 14.15it/s]train:  81%|████████  | 424/523 [00:30<00:06, 14.16it/s]train:  83%|████████▎ | 432/523 [00:31<00:06, 13.33it/s]train:  84%|████████▍ | 440/523 [00:31<00:06, 13.56it/s]train:  85%|████████▌ | 447/523 [00:32<00:05, 13.68it/s]train:  87%|████████▋ | 455/523 [00:32<00:04, 13.79it/s]train:  89%|████████▊ | 463/523 [00:33<00:04, 13.86it/s]train:  90%|█████████ | 471/523 [00:34<00:03, 13.95it/s]train:  92%|█████████▏| 479/523 [00:34<00:03, 14.01it/s]train:  93%|█████████▎| 487/523 [00:35<00:02, 13.74it/s]train:  94%|█████████▍| 494/523 [00:35<00:02, 13.40it/s]train:  96%|█████████▌| 501/523 [00:36<00:01, 12.59it/s]train:  97%|█████████▋| 508/523 [00:37<00:01, 12.45it/s]train:  98%|█████████▊| 515/523 [00:38<00:00,  9.58it/s]train: 100%|█████████▉| 522/523 [00:38<00:00, 10.13it/s]train: 100%|██████████| 523/523 [00:38<00:00, 13.44it/s]
val:   0%|          | 0/24 [00:00<?, ?it/s]val:  12%|█▎        | 3/24 [00:00<00:05,  3.79it/s]val:  38%|███▊      | 9/24 [00:01<00:01,  7.54it/s]val:  58%|█████▊    | 14/24 [00:01<00:01,  8.51it/s]val:  79%|███████▉  | 19/24 [00:02<00:00,  7.91it/s]val: 100%|██████████| 24/24 [00:03<00:00,  7.99it/s]
current validation mse is:  0.025837965
predicted y_val head is: 
                            pred   label
datetime   instrument                  
2011-12-07 y1-y2       0.169267  0.3702
2011-12-08 y1-y2       0.168882  0.3125
2011-12-09 y1-y2       0.162282  0.3086
2011-12-12 y1-y2       0.187298  0.3185
2011-12-13 y1-y2       0.182318  0.3414
2011-12-14 y1-y2       0.150701  0.3252
2011-12-15 y1-y2       0.138903  0.4054
2012-01-03 y1-y2       0.179176  0.2276
2012-01-04 y1-y2       0.177060  0.1895
2012-01-05 y1-y2       0.174173  0.0920
2012-01-06 y1-y2       0.185910  0.0619
2012-01-09 y1-y2       0.202453  0.0156
2012-01-10 y1-y2       0.210807  0.0501
2012-01-11 y1-y2       0.214315  0.0346
2012-01-12 y1-y2       0.206859  0.0053
2012-01-13 y1-y2       0.207967  0.0047
2012-01-17 y1-y2       0.200917  0.0322
2012-01-18 y1-y2       0.199701  0.0054
2012-01-19 y1-y2       0.201727  0.0000
2012-01-20 y1-y2       0.188478  0.0000
current epoch: 1
gpu-pr1-02                Mon Aug  5 12:26:09 2024  550.90.07
[0] NVIDIA A100 80GB PCIe | 40°C,   3 % |   585 / 81920 MB | y5jing(576M)
[1] NVIDIA A100-PCIE-40GB | 32°C,   0 % |     3 / 40960 MB |

train:   0%|          | 0/523 [00:00<?, ?it/s]train:   1%|          | 6/523 [00:00<00:47, 10.79it/s]train:   2%|▏         | 13/523 [00:01<00:43, 11.86it/s]train:   4%|▍         | 20/523 [00:01<00:41, 12.20it/s]train:   5%|▌         | 27/523 [00:02<00:39, 12.41it/s]train:   7%|▋         | 34/523 [00:02<00:38, 12.61it/s]train:   8%|▊         | 41/523 [00:03<00:37, 12.69it/s]train:   9%|▉         | 48/523 [00:03<00:37, 12.71it/s]train:  11%|█         | 55/523 [00:04<00:36, 12.75it/s]train:  12%|█▏        | 62/523 [00:04<00:36, 12.76it/s]train:  13%|█▎        | 69/523 [00:05<00:35, 12.73it/s]train:  15%|█▍        | 76/523 [00:06<00:35, 12.75it/s]train:  16%|█▌        | 83/523 [00:06<00:34, 12.81it/s]train:  17%|█▋        | 90/523 [00:07<00:35, 12.10it/s]train:  19%|█▊        | 97/523 [00:07<00:34, 12.33it/s]train:  20%|█▉        | 104/523 [00:08<00:33, 12.45it/s]train:  21%|██        | 111/523 [00:08<00:32, 12.52it/s]train:  23%|██▎       | 118/523 [00:09<00:32, 12.58it/s]train:  24%|██▍       | 125/523 [00:09<00:31, 12.60it/s]train:  25%|██▌       | 132/523 [00:10<00:31, 12.58it/s]train:  27%|██▋       | 139/523 [00:11<00:30, 12.62it/s]train:  28%|██▊       | 146/523 [00:11<00:29, 12.64it/s]train:  29%|██▉       | 153/523 [00:12<00:29, 12.65it/s]train:  31%|███       | 160/523 [00:12<00:28, 12.65it/s]train:  32%|███▏      | 167/523 [00:13<00:28, 12.70it/s]train:  33%|███▎      | 174/523 [00:13<00:27, 12.71it/s]train:  35%|███▍      | 181/523 [00:14<00:26, 12.72it/s]train:  36%|███▌      | 188/523 [00:14<00:26, 12.72it/s]train:  37%|███▋      | 195/523 [00:15<00:25, 12.70it/s]train:  39%|███▊      | 202/523 [00:16<00:25, 12.73it/s]train:  40%|███▉      | 209/523 [00:16<00:24, 12.71it/s]train:  41%|████▏     | 216/523 [00:17<00:24, 12.77it/s]train:  43%|████▎     | 223/523 [00:17<00:23, 12.80it/s]train:  44%|████▍     | 230/523 [00:18<00:22, 12.75it/s]train:  45%|████▌     | 237/523 [00:18<00:22, 12.71it/s]train:  47%|████▋     | 244/523 [00:19<00:21, 12.69it/s]train:  48%|████▊     | 251/523 [00:19<00:21, 12.67it/s]train:  49%|████▉     | 258/523 [00:20<00:20, 12.66it/s]train:  51%|█████     | 265/523 [00:20<00:20, 12.72it/s]train:  52%|█████▏    | 272/523 [00:21<00:20, 12.18it/s]train:  53%|█████▎    | 279/523 [00:22<00:19, 12.32it/s]train:  55%|█████▍    | 286/523 [00:22<00:19, 12.46it/s]train:  56%|█████▌    | 293/523 [00:23<00:18, 12.53it/s]train:  57%|█████▋    | 300/523 [00:23<00:17, 12.54it/s]train:  59%|█████▊    | 307/523 [00:24<00:17, 12.54it/s]train:  60%|██████    | 314/523 [00:24<00:16, 12.59it/s]train:  61%|██████▏   | 321/523 [00:25<00:16, 12.62it/s]train:  63%|██████▎   | 328/523 [00:26<00:15, 12.64it/s]train:  64%|██████▍   | 335/523 [00:26<00:14, 12.64it/s]train:  65%|██████▌   | 342/523 [00:27<00:14, 12.70it/s]train:  67%|██████▋   | 349/523 [00:27<00:13, 12.69it/s]train:  68%|██████▊   | 356/523 [00:28<00:13, 12.74it/s]train:  69%|██████▉   | 363/523 [00:28<00:12, 12.70it/s]train:  71%|███████   | 370/523 [00:29<00:12, 12.67it/s]train:  72%|███████▏  | 377/523 [00:29<00:11, 12.69it/s]train:  73%|███████▎  | 384/523 [00:30<00:10, 12.64it/s]train:  75%|███████▍  | 391/523 [00:31<00:10, 12.66it/s]train:  76%|███████▌  | 398/523 [00:31<00:09, 12.65it/s]train:  77%|███████▋  | 405/523 [00:32<00:09, 12.67it/s]train:  79%|███████▉  | 412/523 [00:32<00:08, 12.69it/s]train:  80%|████████  | 419/523 [00:33<00:08, 12.73it/s]train:  81%|████████▏ | 426/523 [00:33<00:07, 12.77it/s]train:  83%|████████▎ | 433/523 [00:34<00:07, 12.73it/s]train:  84%|████████▍ | 440/523 [00:34<00:06, 12.76it/s]train:  85%|████████▌ | 447/523 [00:35<00:05, 12.73it/s]train:  87%|████████▋ | 454/523 [00:35<00:05, 12.71it/s]train:  88%|████████▊ | 461/523 [00:36<00:04, 12.67it/s]train:  89%|████████▉ | 468/523 [00:37<00:04, 12.70it/s]train:  91%|█████████ | 475/523 [00:37<00:03, 12.71it/s]train:  92%|█████████▏| 482/523 [00:38<00:03, 12.71it/s]train:  93%|█████████▎| 489/523 [00:38<00:02, 12.69it/s]train:  95%|█████████▍| 496/523 [00:39<00:02, 12.70it/s]train:  96%|█████████▌| 503/523 [00:39<00:01, 12.69it/s]train:  98%|█████████▊| 510/523 [00:40<00:01, 12.65it/s]train:  99%|█████████▉| 517/523 [00:40<00:00, 12.65it/s]train: 100%|██████████| 523/523 [00:41<00:00, 12.63it/s]
val:   0%|          | 0/24 [00:00<?, ?it/s]val:  25%|██▌       | 6/24 [00:00<00:01, 10.19it/s]val:  54%|█████▍    | 13/24 [00:01<00:00, 11.54it/s]val:  83%|████████▎ | 20/24 [00:01<00:00, 12.01it/s]val: 100%|██████████| 24/24 [00:02<00:00, 11.86it/s]
current validation mse is:  0.02368658
predicted y_val head is: 
                            pred   label
datetime   instrument                  
2011-12-07 y1-y2       0.203106  0.3702
2011-12-08 y1-y2       0.220621  0.3125
2011-12-09 y1-y2       0.231369  0.3086
2011-12-12 y1-y2       0.199871  0.3185
2011-12-13 y1-y2       0.201012  0.3414
2011-12-14 y1-y2       0.192614  0.3252
2011-12-15 y1-y2       0.201450  0.4054
2012-01-03 y1-y2       0.235308  0.2276
2012-01-04 y1-y2       0.192008  0.1895
2012-01-05 y1-y2       0.226409  0.0920
2012-01-06 y1-y2       0.238836  0.0619
2012-01-09 y1-y2       0.285868  0.0156
2012-01-10 y1-y2       0.284682  0.0501
2012-01-11 y1-y2       0.230628  0.0346
2012-01-12 y1-y2       0.196395  0.0053
2012-01-13 y1-y2       0.199971  0.0047
2012-01-17 y1-y2       0.209275  0.0322
2012-01-18 y1-y2       0.230250  0.0054
2012-01-19 y1-y2       0.190681  0.0000
2012-01-20 y1-y2       0.164857  0.0000
Traceback (most recent call last):
  File "/mnt/hpc/work/y5jing/project2_test_4/benchmark_dynamic/main.py", line 326, in <module>
    m.workflow(reload_path=None)
  File "/mnt/hpc/work/y5jing/project2_test_4/benchmark_dynamic/main.py", line 316, in workflow
    framework = self.offline_training(data=data, save_path=save_path, reload_path=reload_path)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/hpc/work/y5jing/project2_test_4/benchmark_dynamic/main.py", line 223, in offline_training
    framework.fit(rolling_tasks_data['train'], rolling_tasks_data['valid'], checkpoint_path=save_path)
  File "/mnt/hpc/work/y5jing/project2_test_4/benchmark_dynamic/src/model.py", line 145, in fit
    torch.save(mse_all, "results/train_mse.pkl")    # requires torch load to unlock
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/y5jing/.local/lib/python3.11/site-packages/torch/serialization.py", line 627, in save
    with _open_zipfile_writer(f) as opened_zipfile:
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/y5jing/.local/lib/python3.11/site-packages/torch/serialization.py", line 501, in _open_zipfile_writer
    return container(name_or_buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/y5jing/.local/lib/python3.11/site-packages/torch/serialization.py", line 472, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Parent directory results does not exist.
